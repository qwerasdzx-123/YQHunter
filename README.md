# YQHunter v3.0

YQHunter是一款基于Go语言开发的综合性Web安全扫描工具，专为安全研究人员和渗透测试工程师设计。该工具集成了多种安全检测功能，能够帮助用户快速识别Web应用程序中的安全漏洞，包括服务器端请求伪造、跨域资源共享配置错误、隐藏目录枚举以及技术栈指纹识别等功能。

本项目的设计理念是提供一个轻量级、高效且易于扩展的安全扫描框架。用户可以通过命令行界面快速启动扫描任务，支持多种输出格式的报告生成，包括HTML、JSON、CSV和TXT，满足不同场景下的报告需求。YQHunter采用了模块化的架构设计，各个扫描模块相互独立，便于后续的功能扩展和维护升级。

## 核心功能

YQHunter提供了六大核心安全扫描模块，覆盖了Web应用安全评估的主要方面。每个模块都经过精心设计，能够在保证扫描效率的同时提供准确的检测结果。

### 服务器端请求伪造检测

服务器端请求伪造（SSRF）是一种严重的安全漏洞，攻击者可以通过目标服务器向内部网络或外部服务发起请求。YQHunter的SSRF检测模块能够通过向目标应用注入各种测试URL，检测应用是否存在未对用户输入进行严格验证的漏洞。该模块内置了多种测试用例，包括普通HTTP URL、IPv4和IPv6本地地址、以及各种特殊的URL格式。扫描结果会详细记录每个可疑漏洞的利用参数、响应特征和风险等级，帮助用户快速定位和修复安全问题。

SSRF检测模块采用了智能的响应分析算法，能够识别出由内部网络地址返回的特征响应，如AWS元数据服务返回的XML格式数据、localhost返回的默认页面内容等。当检测到可疑响应时，工具会自动进行二次验证，排除误报情况，确保扫描结果的准确性。

### 跨域资源共享配置检测

跨域资源共享（CORS）配置错误是Web应用中常见的安全问题，不正确的CORS策略可能导致敏感数据被恶意网站窃取。YQHunter的CORS检测模块通过向目标发送携带不同Origin头的预检请求和实际请求，分析服务器的响应头信息，判断是否存在不安全的跨域策略。检测项目包括允许任意来源访问（Access-Control-Allow-Origin: *）、允许携带凭据的任意来源访问、以及反射Origin头等配置缺陷。

该模块的检测逻辑严格遵循Web安全标准，能够识别出多种CORS配置模式。对于发现的每个CORS漏洞，报告都会详细说明漏洞的形成原因、可能造成的危害以及修复建议，帮助开发人员理解并解决安全问题。

### 目录枚举扫描

目录枚举是渗透测试和信息收集阶段的重要环节，攻击者可以通过发现隐藏的管理后台、备份文件、配置文件等敏感资源来进一步扩大攻击面。YQHunter的目录枚举模块内置了常用的目录和文件名字典，同时也支持用户自定义字典文件。扫描器采用多线程并发的方式进行目录探测，能够在短时间内完成大规模的目录扫描任务。

目录枚举模块支持HEAD请求方法，能够快速判断目标路径的存在性，同时避免触发不必要的服务端处理逻辑。对于返回非404状态码的路径，工具会进一步记录其状态码、响应内容长度等信息，帮助用户分析每个发现路径的用途和价值。该模块还支持代理配置，可以在需要隐藏扫描源或绕过简单防护的场景下使用。

### 指纹识别

Web应用的指纹识别是安全评估的基础工作，通过分析目标应用的响应特征，可以快速识别出目标使用的技术栈、框架版本和第三方组件信息。这些信息对于发现已知漏洞、制定渗透测试策略都具有重要价值。YQHunter的指纹识别模块内置了超过八千条指纹规则，覆盖了市场上主流的Web服务器、Web框架、CMS系统、JavaScript库和云服务等。

指纹识别模块采用多维度匹配策略，包括HTTP响应头分析（如Server、X-Powered-By）、HTML页面特征分析（如meta标签、特定class名称）、favicon.ico哈希比对等多种识别方式。对于识别出的技术栈信息，工具会显示其来源和置信度，帮助用户判断识别结果的可靠性。识别结果可以导出为结构化的JSON格式，便于与其他安全工具集成使用。

### API端点发现

现代Web应用普遍采用RESTful API架构，API端点的暴露可能带来未授权访问、信息泄露等安全风险。YQHunter的API端点发现模块通过探测常见的API路径前缀和常见的API端点模式，快速识别目标应用中可能存在的API接口。该模块内置了多种API路径模式，包括版本化API路径（如/api/v1、/api/v2）、GraphQL端点、Swagger文档路径等。

对于发现的API端点，工具会记录其URL路径和HTTP方法。由于API端点通常需要认证或特定参数才能返回有意义的数据，本模块仅进行初步的可达性检测，发现潜在的API暴露情况。检测结果可以帮助安全测试人员进一步进行API安全测试，发现认证绕过、越权访问等更深层次的安全问题。

### 爬虫功能

Web爬虫模块为安全扫描提供了基础的页面发现能力，能够自动抓取目标网站的所有可达页面，发现隐藏的链接、表单和参数。爬虫采用广度优先的遍历策略，支持配置最大爬取深度和页面数量限制，避免在大型网站上的无限循环。爬虫会自动处理相对路径、绝对路径和各种特殊链接格式，确保能够发现尽可能多的页面资源。

爬虫模块集成了表单信息收集功能，能够识别页面中的HTML表单并记录其提交方法、action URL和表单字段名称。这些信息对于后续的漏洞测试（如SQL注入、跨站脚本）具有重要的参考价值。爬虫还支持排除特定路径的配置，用户可以设置不希望被爬取登出、支付等敏感页面，避免意外触发敏感操作。

## 安装指南

YQHunter的安装过程简单直接，用户可以根据自己的操作系统选择合适的安装方式。无论是在本地环境进行开发测试，还是在服务器上进行自动化扫描部署，YQHunter都能够提供便捷的安装体验。

### 环境要求

在安装YQHunter之前，用户需要确保系统中已经安装了Go语言环境。YQHunter要求Go版本不低于1.21，这是为了确保工具能够使用Go语言的最新特性和性能优化。用户可以通过运行go version命令来检查系统中Go语言的版本信息。如果系统中未安装Go语言，用户可以从Go语言官方网站（https://golang.org/dl/）下载对应操作系统的安装包进行安装。

除了Go语言环境之外，YQHunter还需要一些系统级别的依赖支持。主要包括操作系统自带的网络工具和文件操作能力。由于YQHunter使用标准的Go语言库实现，不依赖任何外部的原生扩展，因此可以在Windows、Linux和macOS等主流操作系统上正常运行。内存方面，建议至少分配512MB的可用内存给YQHunter使用，以确保大规模扫描时的稳定性。

### 从源码编译

从源码编译安装是获取YQHunter最新功能的推荐方式。首先，用户需要克隆项目的源代码仓库到本地。执行git clone命令后，代码仓库会被下载到当前目录下的yqhunter文件夹中。进入项目目录后，用户需要下载项目的依赖包，这一步骤通过运行go mod download命令完成，Go包管理器会自动从官方仓库下载所有需要的依赖项。

依赖包下载完成后，用户可以执行go build命令编译项目。编译过程会将所有的Go源代码编译为可执行文件。如果用户希望将可执行文件安装到系统的PATH路径中以便全局使用，可以执行go install命令。编译完成后，用户可以直接运行yqhunter --help来验证安装是否成功。如果看到工具的帮助信息输出，说明安装过程已经完成，可以开始使用了。

### 二进制发行版

对于不方便从源码编译的用户，项目也提供了预编译的二进制发行版。用户可以从项目的GitHub Releases页面下载对应操作系统的压缩包。下载完成后，将压缩包解压到任意目录，即可直接运行其中的可执行文件。这种安装方式适合快速上手体验或在生产环境中快速部署使用。

使用二进制发行版时，用户可以将解压目录添加到系统的PATH环境变量中，这样就可以在任意位置直接调用yqhunter命令。对于Windows用户，也可以将可执行文件复制到系统的System32目录下实现类似效果。建议用户定期从GitHub Releases页面检查更新，及时获取最新的功能改进和安全修复。

## 使用指南

YQHunter提供了丰富的命令行参数，用户可以通过组合不同的参数来定制扫描行为。本章节将详细介绍各种扫描场景下的使用方法，包括参数配置、输出控制和结果解读等方面的内容。

### 基础扫描命令

YQHunter的使用方式遵循标准的命令行工具模式，核心参数包括目标URL（-u/--url）和扫描类型参数。以下是几种最常用的扫描命令示例，展示了针对不同安全检测需求的典型用法。

执行SSRF漏洞扫描时，使用-x或--ssrf参数指定启用SSRF检测模块。命令格式为yqhunter -x -u https://example.com，这条命令会对目标网站进行SSRF漏洞检测。扫描完成后，结果会输出到控制台，并且可以指定-o参数将结果保存到文件中。例如，yqhunter -x -u https://example.com -o result.json会将扫描结果以JSON格式保存到result.json文件。

CORS配置检测使用-c或--cors参数。与SSRF扫描类似，可以通过-y参数指定输出文件格式，支持txt、json、csv和html四种格式。目录枚举扫描使用-d或--dir参数，支持通过-z参数指定自定义字典文件，例如yqhunter -d -u https://example.com -z custom.txt会使用指定的字典文件进行目录探测。指纹识别使用-f或--fingerprint参数，全面扫描则使用-a参数启用所有检测模块。

### 输出格式控制

YQHunter支持四种输出格式，用户可以根据后续处理需求选择合适的格式。TXT格式适合快速查看和人工阅读，输出内容包含扫描概要和每个漏洞的详细信息。JSON格式输出结构化的数据，便于程序解析处理，适合与其他安全工具集成或在流水线中使用。CSV格式适合在电子表格软件中打开查看和进一步分析。HTML格式提供美观的可视化报告，包含图表和详细分类。

输出格式的指定可以通过文件扩展名自动识别，也可以通过-y参数显式指定。例如，-o report.html会生成HTML格式报告，而-y参数则强制指定输出格式。当用户未指定输出文件时，工具会自动使用当前时间生成默认文件名，格式为2026-01-20-15-30.txt。这种自动命名机制确保每次扫描的结果都有唯一的文件名，不会相互覆盖。

### 代理配置

在某些场景下，用户可能需要通过代理服务器发起扫描请求，例如隐藏扫描源IP、绕过IP限制或进行安全测试。YQHunter支持HTTP代理和SOCKS5代理两种方式，可以通过--proxy参数指定。代理地址的格式为协议://地址:端口，例如--proxy http://127.0.0.1:8080指定HTTP代理，--proxy socks5://127.0.0.1:1080指定SOCKS5代理。

代理配置也可以通过配置文件进行设置，这种方式适合长期使用同一代理的场景。在config.yaml文件的general部分配置proxy选项后，无需每次命令行输入代理参数。需要注意的是，代理配置对所有扫描模块生效，包括爬虫、目录枚举等。如果只需要对特定模块使用代理，可能需要修改配置文件或添加更细粒度的代理控制逻辑。

### 高级配置选项

YQHunter提供了多个高级配置选项，用户可以根据实际需求调整扫描行为。并发数配置（--concurrency或配置文件中设置）控制同时进行的HTTP请求数量，较高的并发数可以加快扫描速度，但可能对目标服务器造成更大压力，建议根据目标服务器的承载能力合理设置。超时配置（--timeout）设置单个HTTP请求的最大等待时间，对于响应较慢的目标服务器可以适当调高超时值。

字典文件配置允许用户指定自定义的目录枚举字典。YQHunter内置了常用目录名字典，但对于特定目标可能需要使用更有针对性的字典。用户可以将字典文件放在dictionaries目录下，然后通过-z参数指定文件名，工具会自动在dictionaries目录下查找。如果指定的是完整路径，则优先使用完整路径指向的文件。爬虫模块的深度限制（-D/--depth）控制页面爬取的最大深度，设置为0表示不限制深度，可能会消耗较长时间和资源。

## API文档

YQHunter除了提供命令行界面之外，其内部模块也以Go包的形式提供了编程接口。开发者可以将YQHunter的扫描模块集成到自己的安全工具或自动化流程中，实现更灵活的定制需求。本章节介绍了主要模块的编程接口和使用方法。

### 配置管理

配置管理模块（yqhunter/internal/config）负责加载和管理应用程序的配置信息。LoadConfig函数是配置加载的入口点，接收可选的配置文件路径参数。如果指定了配置文件路径，函数会从该文件加载配置；如果未指定或加载失败，则使用默认配置值。配置结构体Config包含了通用配置（GeneralConfig）、扫描器配置（ScannerConfig）、爬虫配置（SpiderConfig）和报告配置（ReportConfig）四个主要部分。

用户可以通过修改配置结构体的字段来定制扫描行为。例如，禁用SSL证书验证需要将GeneralConfig.SkipSSLVerify设置为true，但出于安全考虑，默认情况下该值为false。扫描器配置中的各个Enable开关可以分别控制是否启用对应的扫描模块。配置模块还提供了EnsureWordlistsExist函数，用于确保字典目录和相关文件的正确初始化。

### 扫描器模块

扫描器模块（yqhunter/internal/scanner）是YQHunter的核心功能模块，提供了各种漏洞检测函数。RunScan函数接收目标URL和配置对象，执行完整的扫描任务并返回ScanResult结构体，其中包含了各个扫描模块的检测结果。开发者也可以单独调用各个扫描函数，如ScanSSRF、ScanCORS、ScanDirectories等，以实现针对性的扫描需求。

Vulnerability结构体定义了漏洞信息的标准格式，包含类型（Type）、URL、载荷（Payload）、严重性（Severity）、描述（Description）和证明（Proof）字段。这种结构化的漏洞信息表示便于后续的处理和报告生成。扫描器模块内部使用了重试机制和超时控制，确保在网络条件不佳时仍能稳定运行。

### HTTP客户端

HTTP客户端模块（yqhunter/internal/httpclient）封装了Go标准库的http.Client，提供了统一的HTTP请求能力。该模块的New函数接收配置对象，创建配置了代理、超时等选项的HTTP客户端。NewWithTimeout函数允许调用者指定自定义超时时间，NewWithNoTimeout函数则创建无超时限制的客户端（已废弃，可能造成资源耗尽风险）。

HTTP客户端模块还包含了SSL/TLS配置，支持跳过证书验证（仅用于测试环境）和自定义TLS版本等高级选项。在生产环境中使用时，建议保持默认的证书验证行为，确保通信安全。

### 爬虫模块

爬虫模块（yqhunter/internal/spider）基于colly库实现了Web页面抓取功能。RunSpider函数接收目标URL、爬虫配置和深度限制参数，返回SpiderResult结构体，包含发现的URL列表、表单信息和响应头等内容。爬虫支持并发控制、代理配置和URL过滤等高级功能。

URL验证和安全性检查是该模块的重要安全特性。isSafeURL函数负责检查URL是否包含危险协议（如javascript:、data:）或指向内部网络地址。isSensitiveHeader函数识别并过滤响应头中的敏感信息，如Authorization、Cookie等，防止敏感数据泄露到扫描结果中。

## 项目架构

YQHunter采用了清晰的模块化架构设计，各功能模块职责明确、相互独立，便于理解、维护和扩展。本章节将介绍项目的整体架构设计和各组件之间的关系。

### 模块依赖关系

项目的根目录包含主程序入口（main.go）和命令行配置（cmd/root.go）。internal目录下包含了所有的功能模块，其中config提供配置管理能力，httpclient封装HTTP请求操作，scanner实现核心的漏洞扫描功能，spider提供Web爬虫能力，report负责扫描结果的报告生成，fingerprint和yqfinger提供指纹识别功能。

模块之间遵循依赖倒置原则，上层模块依赖抽象接口而非具体实现。例如，scanner模块不直接创建HTTP客户端，而是通过httpclient包提供的Client接口进行网络请求。这种设计使得各模块之间的耦合度降低，便于单元测试和功能替换。当需要替换某个实现时，只需确保新实现满足接口契约即可。

### 配置文件结构

项目的配置文件采用YAML格式，结构清晰、层次分明。配置文件的顶级结构包含四个主要部分：general定义通用配置选项，scanner配置扫描器参数，spider配置爬虫行为，report配置报告输出选项。这种结构化的配置格式便于用户理解和修改，也支持使用viper等配置管理库进行高级操作。

配置文件中可以使用环境变量覆盖默认值，这种设计支持在容器化部署场景下的灵活配置。配置模块会优先使用命令行参数指定的值，其次是环境变量，最后是配置文件中的设置。这种优先级机制确保了用户在各种使用场景下都能够方便地定制扫描行为。

## 安全编码规范

YQHunter项目严格遵循安全编码规范，本章节总结了项目开发过程中遵循的安全原则和最佳实践，供其他安全工具开发者参考。

### 输入验证原则

所有的用户输入都必须经过严格的验证和清理才能使用。URL参数需要验证协议类型、主机地址和路径格式，防止注入恶意内容或访问危险资源。文件路径需要检查路径遍历攻击特征，避免越权访问系统文件。正则表达式需要验证用户输入的格式和长度，防止正则表达式拒绝服务攻击。

项目定义了明确的黑名单和白名单规则。危险协议（如javascript:、data:、file:）必须被明确禁止。内部网络地址段（如127.0.0.0/8、192.168.0.0/16、10.0.0.0/8）必须被排除在扫描目标之外。白名单规则定义了允许使用的协议、地址范围和文件格式，只有符合白规则的输入才会被接受处理。

### 输出编码处理

扫描结果和报告输出时，需要对特殊字符进行适当的编码处理，防止跨站脚本等二次攻击。HTML输出需要对<、>、"、'等字符进行实体编码。JSON输出需要正确转义控制字符。日志输出需要避免格式化字符串漏洞，确保所有用户可控的数据都经过安全处理。

敏感信息的处理遵循最小化原则。用户的认证凭据、API密钥等敏感数据不会被记录到日志或报告中。响应头中可能包含的敏感信息会被自动过滤。配置文件中的敏感字段应该使用加密存储或环境变量引用，而非明文保存。

### 依赖安全管理

项目依赖的第三方库需要经过安全审查才能引入。所有依赖都应该使用固定版本，避免因依赖更新引入未知的安全问题。定期使用依赖漏洞扫描工具（如trivy、gosec）检查项目依赖，及时修复已知漏洞。关注依赖库的社区动态，对已宣布弃用或不再维护的依赖进行替换。

## 贡献指南

YQHunter项目欢迎社区贡献者参与项目开发，本章节介绍了参与贡献的方式和需要遵循的规范。

### 开发环境设置

贡献者需要先fork项目仓库，然后克隆自己的fork副本到本地开发环境。建议创建一个独立的开发分支进行功能开发，避免直接在main分支上工作。代码修改完成后，提交Pull Request请求将更改合并到上游仓库。提交信息应该清晰描述更改内容和目的，遵循Conventional Commits格式规范。

本地开发时，运行项目的测试套件确保修改没有破坏现有功能。使用go fmt和go vet进行代码格式化和静态检查。遵循项目的代码风格和命名规范，保持代码库的一致性。对于重大功能更改，建议先在Issue中讨论设计思路，获得社区反馈后再开始实现。

### 代码审查流程

所有提交到主分支的代码都必须经过代码审查。审查关注点包括功能正确性、代码质量、安全合规性和测试覆盖。安全相关的更改需要额外的安全审查，确保不会引入新的安全漏洞。审查者应该提供建设性的反馈，帮助贡献者改进代码质量。

## 许可证信息

YQHunter项目采用MIT许可证进行授权。这是一个宽松的开源许可证，允许用户自由使用、修改和分发软件的源代码和二进制形式，只需保留原始的版权声明和许可证文本即可。

MIT许可证的主要条款包括：授予任何人使用本软件进行任何目的的权利，包括商业使用；允许复制、修改、合并、发布、分发、再授权和/或销售本软件；要求在所有副本或重要部分中包含上述版权声明和本许可声明；不提供任何担保，使用者承担使用本软件的所有风险。

使用本软件即表示您理解并同意上述条款。如有任何关于许可证的问题，请参考完整的许可证文本或联系项目维护者。

## 联系方式

如果您在使用过程中遇到问题或有功能建议，欢迎在GitHub Issues中提交反馈。对于安全相关的漏洞报告，请通过私密渠道联系项目维护者，避免在公开渠道泄露漏洞细节影响其他用户。

项目维护者会定期审查Issue和Pull Request，但无法保证响应时间。对于紧急问题或重要功能需求，建议通过更直接的方式联系项目团队。感谢您对YQHunter项目的关注和支持。
